name: synapse
display-name: Synapse
summary: Matrix synapse chat server.
description: |
  A charm for the matrix synapse chat server.

  The charm deploys a matrix synapse server.

  Synapse is a drop in replacement for other chat servers like Mattermost and Slack.

  This charm is useful if you want to spin up your own chat instance.

assumes:
  - k8s-api

containers:
  synapse:
    resource: synapse-image
    mounts:
      - storage: data
        location: /data
  synapse-nginx:
    resource: synapse-nginx-image

resources:
  synapse-image:
    type: oci-image
    description: OCI image for Synapse
    upstream-source: matrixdotorg/synapse:latest
  synapse-nginx-image:
    type: oci-image
    description: Docker image for nginx Synapse
    auto-fetch: true

storage:
  data:
    type: filesystem
    location: /data

requires:
  database:
    interface: postgresql_client
    limit: 1
  redis:
    interface: redis
    limit: 1
  ingress:
    interface: ingress
    limit: 1

peers:
  synapse-peers:
    interface: synapse-instance

